---
title: 'OpenCV和AI工具'
linkTitle: 'OpenCV和AI工具'
weight: 14
description: '宜美智自训练系统中可用的半自动和自动标注工具概述.'
---

在**AI**和**OpenCV**工具的帮助下，以半自动和自动模式对数据进行标注.

参阅:

- [交互器](#交互器)
  - [AI工具: 使用交互器标注](#ai工具-使用交互器标注)
  - [AI工具: 增加额外的点](#ai工具-增加额外的点)
  - [AI工具: 删除点](#ai工具-删除点)
  - [OpenCV: 智能剪刀](#opencv-智能剪刀)
  - [设置](#设置)
  - [交互器模型](#交互器模型)
- [目标检测](#目标检测)
  - [标签匹配](#标签匹配)
  - [使用目标检测标注](#使用目标检测标注)
  - [目标检测模型](#目标检测模型)

## 交互器

交互器是**AI**和**OpenCV**工具的一部分.

使用交互器标记图像中的对象
半自动创建多边形.

创建多边形时，可以使用正点
或者是负点(对于某些模型):

- **正点**定义对象所在的区域。
- **负点**定义对象不在的区域。

![](/images/image188_detrac.jpg)

### AI工具: 使用交互器标注

要使用交互器进行标注，请执行以下操作:

1. 点击**魔术棒** ![魔术棒](/images/image189.jpg), 然后转到**交互器**标签页.
2. 从**标签**下拉菜单中，选择多边形的标签.
3. 从**交互器**下拉菜单中，选择一个模型 (详阅 [交互器模型](#交互器模型)).
   <br>点击**问号**以查看每个模型的信息:
   <br>![](/images/image114_detrac.jpg)
4. (可选)如果模型返回掩膜，你需要
   转换掩膜到多边形，使用**转换掩膜到多边形**切换.
5. 点击 **交互**.
6. 左键点击可添加正点，右键点击可添加负点.
   <br>可以添加的点数取决于模型.
7. 在顶部菜单, 点击 **完成** (或者 **Shift+N**, **N**).

### AI工具: 增加额外的点

> **注意:**更多的点可以提高轮廓的准确性，但会使形状编辑更加困难.
> 较少的点使形状编辑更容易，但降低了轮廓精度.

每个模型都有一个用于注释的最小所需点数。
一旦达到了所需的点数，就开始请求自动发送到服务器。
服务器处理请求并向帧中添加一个多边形。

为了得到一个更准确的轮廓, 首先推迟服务器的请求来增加点数:

1. 按住**Ctrl**键.
   <br>在顶部面板上，**推迟**按钮将变成蓝色.
2. 向图像中添加点.
3. 当准备好时，松开**Ctrl**键.

如果你在对象完成时使用了**将掩膜转为多边形**，
你可以像编辑多边形一样编辑它.

你可以用滑块改变多边形的点数:

![](/images/image224.jpg)

### AI工具: 删除点

<br>要删除一个点，请执行以下操作:

1. 将光标悬停在要删除的点上.
2. 如果这个点可以被删除，它会放大，光标会变成一个十字.
3. 左键点击这个点.

### OpenCV: 智能剪刀

要使用**智能剪刀**, 请执行以下操作:

1. 在菜单栏上，单击 **OpenCV**![OpenCV](/images/image201.jpg) 然后等待库加载.

   <br>![](/images/image198.jpg)

2. 转到**Drawing**选项卡，选择标签，并单击**智能剪刀**按钮.

   ![](/images/image199.jpg)

3. 在已分配对象的边界上添加第一个点. <br> 你会看到一条线重复物体的轮廓.
4. 添加第二个点，使前一个点在限制阈值内.
   <br>之后，在这些点之间会自动创建一条重复对象边界的线.
   ![](/images/image200_detrac.jpg)
5. 要完成放置点，在顶部菜单上单击**完成**(或键盘上的**N**).

这样就创建了一个多边形.

你可以用滑块改变多边形的点数:

![](/images/image224.jpg)

要增加或降低操作阈值，按住**Ctrl**并滚动鼠标滚轮.

在绘制过程中，可以用鼠标左键点击最后一个点来删除它.

### 设置

- 如何调整多边形,
  详阅 [对象栏](/docs/manual/basics/objects-sidebar/#appearance).

- 有关多边形的更多信息，请参见
  [标注多边形](/docs/manual/advanced/annotation-with-polygons/).

### 交互器模型

<!--lint disable maximum-line-length-->

| 模型                                                     | 工具     | 描述                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | 例子                                           |
| --------------------------------------------------------- | -------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------- |
| Segment Anything Model (SAM)                              | AI工具 | 分割任意模型(SAM)产生高<br>质量的对象掩膜，它可用于生成图像中所有对象的<br>掩膜。它在包含1100万张图像的数据集<br>和<br> 11亿个掩膜的数据集上进行了训练，并在各种分割任务上具有强大的零样本性能。<br><br>更多信息，请参见: <li>[GitHub: Segment Anything](https://github.com/facebookresearch/segment-anything) <li>[Site: Segment Anything](https://segment-anything.com/)<li>[Paper: Segment Anything](https://ai.facebook.com/research/publications/segment-anything/)               | ![](/images/interactors_SAM.gif)                  |
| Deep extreme <br>cut (DEXTR)                              | AI工具  | 这是原始模型的优化版本，<br>，于2017年底推出。它使用对象<br>的极值点的<br>信息来获得它的掩膜。然后掩膜<br>被转换为多边形。<br>目前这是CPU上最快的交互器。<br><br>更多信息，请参见: <li>[GitHub: DEXTR-PyTorch](https://github.com/scaelles/DEXTR-PyTorch) <li>[Site: DEXTR-PyTorch](https://cvlsegmentation.github.io/dextr)<li>[Paper: DEXTR-PyTorch](https://arxiv.org/pdf/1711.09081.pdf)                                                                                         | ![](/images/dextr_example.gif)                    |
| Feature backpropagating <br>refinement <br>scheme (f-BRS) | AI工具  | 该模型允许使用正点(应该在前景上左键点击)<br>和负点(如果需要，应该在背景上右键点击)<br>掩膜<br>。如果可能的话，建议在GPU上运行模型。<br><br>有关更多信息，请参见: <li>[GitHub: f-BRS](https://github.com/saic-vul/fbrs_interactive_segmentation) <li>[Paper: f-BRS](https://arxiv.org/pdf/2001.10331.pdf)                                                                                                                                                       | ![](/images/fbrs_example.gif)                     |
| High Resolution <br>Net (HRNet)                           | AI工具  | 该模型允许使用正点(应该在前景上左键点击)<br>和负点(如果需要，应该在背景上右键点击)<br>掩膜<br>。如果可能的话，建议在GPU上运行模型。<br><br>有关更多信息，请参见: <li>[GitHub: HRNet](https://github.com/saic-vul/ritm_interactive_segmentation) <li>[Paper: HRNet](https://arxiv.org/pdf/2102.06583.pdf)                                                                                                                                                 | ![](/images/hrnet_example.gif)                    |
| Inside-Outside-Guidance<br>(IOG)                          | AI工具  | T他的模型使用边界框和内部/外部点来创建一个掩膜。<br>首先，你需要创建一个边界框来包裹对象。<br>然后你需要使用正负点来<br>告诉模型哪里是前景，哪里是背景。<br>负点是可选的。<br><br>有关更多信息，请参阅:: <li>[GitHub: IOG](https://github.com/shiyinzhang/Inside-Outside-Guidance) <li>[Paper: IOG](https://openaccess.thecvf.com/content_CVPR_2020/papers/Zhang_Interactive_Object_Segmentation_With_Inside-Outside_Guidance_CVPR_2020_paper.pdf) | ![](/images/iog_example.gif)                      |
| 智能剪刀                                      | OpenCV   | 智能剪刀是一种CV方法，<br>通过放置点并在点与点之间<br>自动绘制直线来创建多边形。<br>相邻点之间的距离受到动作阈值的限制，<br>显示为与光标绑定的红色正方形。<br><br>有关更多信息，请参见: <li>[Site: Intelligent Scissors Specification](https://docs.opencv.org/4.x/df/d6b/classcv_1_1segmentation_1_1IntelligentScissorsMB.html)                                                                                                                                          | ![int scissors](/images/intelligent_scissors.gif) |

<!--lint enable maximum-line-length-->

## 目标检测

目标检测是**AI**工具的一部分.

使用目标检测自动识别和定位图像中的物体.

### 标签匹配

每个模型都是在数据集上训练的，并且只支持数据集的标签.

例如:

- DL模型的标签为 `缺口`.
- 你的任务(或项目)的标签是`针孔`.

为了进行标注，您需要匹配这两个标签以给DL模型一个提示，
在本例中为`缺口` = `针孔`。

如果你有一个不在DL标签列表中的标签，你将无法匹配它们.

因此，支持的深度学习模型只适用于某些标签.
<br>要查看每个型号的标签列表，请参见 [目标检测模型](#目标检测模型).

### 使用目标检测标注

要使用目标检测进行标注，请执行以下操作:

1. 点击**魔术棒** ![Magic wand](/images/image189.jpg), 然后转到**目标检测**选项卡.
2. 从**模型**下拉菜单中选择模型 (参见 [目标检测模型](#目标检测模型)).
3. 从左下拉框中选择DL模型标签，从右下拉框中选择与您的任务匹配的标签.

   ![](/images/image187.jpg)

4. (可选)如果您需要改变预标注的阈值，可填入阈值(区间为(0,1)) 默认0.5..
5. 点击 **标注**.

这个动作会自动标注一帧.
参见[自动标注](/docs/manual/advanced/automatic-annotation/).

### 目标检测模型

<!--lint disable maximum-line-length-->

| 模型                          | 描述                                                                                                                                                                                                                                                                                                                                                                                                                    |
| ------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 内层                      | 用于AOI内层检测使用的AI模型                                                                                                                                                                           |
| 酸性外层                    | 用于AOI酸性外层检测使用的AI模型                                                                              |
| 碱性外层                        | 用于AOI碱性外层检测使用的AI模型                                                                                                     |
| 树脂塞孔 | 用于AOI树脂塞孔检测使用的AI模型                                                                                                                                                                               |
| 金OSP     | 用于AVI金OSP 检测使用的AI模型                                                                                                                                                    |

<!--lint enable maximum-line-length-->